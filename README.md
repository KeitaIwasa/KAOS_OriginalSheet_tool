# KAOS_OriginalSheet_tool

## 概要
このGoogle Apps Script (GAS) スクリプトは、KAOSの発注書原本SpreadSheetで、新しい行が追加された際に商品コードの入力を促し、適切な商品情報をシートに入力します。

## スクリプトの機能

### 1. `setInitialRowCount()`
特定のシート（「食品」、「非食品」）の行数を記録します。記録された行数は、スクリプトのプロパティに保存されます。

### 2. `onEditInstallable(e)`
スプレッドシートが編集された際に実行される関数です。以下の処理を行います：
- 編集されたシートが「食品」または「非食品」であるかを確認。
- 新しい行が追加された場合、ユーザーに商品コードの入力を促すダイアログを表示。
- 入力された商品コードに基づき、新しい行に商品情報を設定。

### 3. `onOpen()`
スプレッドシートが開かれた際に実行される関数です。`setInitialRowCount()` を呼び出して、シートの行数を記録します。

### 4. `editNewRow(sheet, editedRow, scode)`
新しく追加された行に対して行う処理を定義します：
- 商品コードに基づいて商品情報を取得。
- 取得した商品情報を編集された行に入力。
- 「食品」と「非食品」シートで異なる処理を実行。
- 商品が見つからなかった場合、その行を削除。

### 5. `updateONumbers(sheet)`
「並び順」列に順番に自然数を割り当てます。最初の行を除く全ての行に対して実行します。

## 使用方法

1. **初期設定**:
   - 原本のSpreadSheetのGASを開き、以下のスクリプトをコピペする。
      ```ruby:GAS
      // スプレッドシートが編集されたときに実行される関数
      function onEditInstallable(e) {
        setNewRow.setNewRow(e);
      }
      ```
   - ライブラリを以下のIDで検索して追加。
      ```
      12q5b667lKYbkUZX-Q5zQHEAIoKunuPdj-JU_vMOJoNljDtXWPPXICWH5
      ```
   - トリガを以下の要件で追加。
      - 実行する関数を選択：onEditInstallable
      - デプロイ時に実行：HEAD
      - イベントソースを選択：スプレッドシートから
      - イベントの種類を選択：編集時


2. **編集時の動作**:
   - スプレッドシートで編集が行われると `onEditInstallable(e)` がトリガーされ、ライブラリ`setNewRow`の`setNewRow`関数が呼び出されます。
   - 新しい行が追加された場合、ユーザーに商品コードの入力を促すダイアログが表示されます。
   - 商品が見つからなかった場合、その行を削除します。
   - 商品コード(半角数字4桁)を入力すると、対応する商品情報がシートに自動入力されます。
   - 商品情報の更新後に `updateONumbers(sheet)` 関数が呼び出され、「並び順」列に順番に自然数を割り当てます。
